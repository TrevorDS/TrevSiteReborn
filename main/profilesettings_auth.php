<?php

require("../SITE_CONFIG.php");
require("../main/setup.php");
/*
 * Written by Trevor
 * 4/21/21
 * 
 */
////////////////////////////////////////////////////////////////////////////////
// CONSTANTS
////////////////////////////////////////////////////////////////////////////////
global $DB_SERVER_NAME;
global $DB_USERNAME;
global $DB_PASSWORD;
global $DB_NAME;

$TABLE = "user_data";
$UserID = $_POST["UserID"];
$CALLBACK = $PAGES . "profile?user=$UserID";

if (!isset($UserID) || $UserID === null) {
    $CALLBACK = $DEFAULT_CALLBACK_REDIRECT;
}

////////////////////////////////////////////////////////////////////////////////
// Variables
////////////////////////////////////////////////////////////////////////////////
$NEW_BG_COLOR = $_POST["colors"];

////////////////////////////////////////////////////////////////////////////////
// Functions
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
// INIT
////////////////////////////////////////////////////////////////////////////////
// POST VERIFICATION
if (!$_POST) {
    header("Location: $CALLBACK");
    exit;
}

////////////////////////////////////////////////////////////////////////////////
// RUN-TIME
////////////////////////////////////////////////////////////////////////////////
// Create connection
$conn = new mysqli($DB_SERVER_NAME, $DB_USERNAME, $DB_PASSWORD, $DB_NAME);

// Check connection
if ($conn->connect_error) {
    header("Location: $CALLBACK");
    exit;
}

// SQL Command(s)
$bio_sql = "UPDATE $TABLE SET profile_bg_color='" . $NEW_BG_COLOR . "' WHERE user_id='$UserID'";

// Run the SQL Command(s)
$cheese = $conn->query($bio_sql);

$conn->close();


header("Location: $CALLBACK");
exit;
