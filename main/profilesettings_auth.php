<?php

require("../SITE_CONFIG.php");
require("../main/setup.php");
/*
 * Written by Trevor
 * 4/21/21
 * 
 */
////////////////////////////////////////////////////////////////////////////////
// CONSTANTS
////////////////////////////////////////////////////////////////////////////////
$TABLE = "user_data";
$UserID = $_POST["UserID"];
$CALLBACK_PAGE = $PAGES . "profile?user=$UserID";

if (!isset($UserID) || $UserID === null) {
    $CALLBACK_PAGE = $DEFAULT_CALLBACK_REDIRECT;
}

////////////////////////////////////////////////////////////////////////////////
// Variables
////////////////////////////////////////////////////////////////////////////////
$NEW_BG_COLOR = $_POST["colors"];

////////////////////////////////////////////////////////////////////////////////
// Functions
////////////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////////////////////////
// INIT
////////////////////////////////////////////////////////////////////////////////
// POST VERIFICATION
if (!$_POST) {
    header("Location: $CALLBACK_PAGE");
    exit;
}

////////////////////////////////////////////////////////////////////////////////
// RUN-TIME
////////////////////////////////////////////////////////////////////////////////

// Create connection
$conn = new mysqli($DB_SERVER_NAME, $DB_USERNAME, $DB_PASSWORD, $DB_NAME);

// Check connection
if ($conn->connect_error) {
    header("Location: $CALLBACK_PAGE");
    exit;
}

// SQL Command(s)
$bio_sql = "UPDATE $TABLE SET profile_bg_color='" . $NEW_BG_COLOR . "' WHERE user_id='$UserID'";

// Run the SQL Command(s)
$cheese = $conn->query($bio_sql);
        
$conn->close();


header("Location: $CALLBACK_PAGE");
exit;